<script>
    async function loadData() {
        const r = await fetch("/api/data");
        const params = await r.json();

        document.getElementById("i").textContent = params["Imię_1"];
        document.getElementById("n").textContent = params["Nazwisko_1"];
        document.getElementById("w").textContent = params["Wiek_1"];
        document.getElementById("p").textContent = params["Płeć_1"];
        document.getElementById("r").textContent = params["Rasa_1"];
    }

    // SSE: automatic realtime updates
    const evt = new EventSource("/events");
    evt.onmessage = async (e) => {
        const msg = JSON.parse(e.data);

        if (msg.updated) {
            console.log("SSE update detected → reloading data");
            await loadData();
        }
    };

    // Manual refresh button
    document.getElementById("refreshBtn").onclick = async () => {
        await fetch("/api/refresh");
        await loadData();
        alert("Data refreshed!");
    };

    // Load initial data on page load
    loadData();
</script>
