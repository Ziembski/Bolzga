<!DOCTYPE html>
<html>
<head>
    <title>Aslan</title>
</head>
<body>
<h1>Aslan</h1>

<div>
    <p id="imie"></p>
    <p id="nazwisko"></p>
    <p id="wiek"></p>
    <p id="plec"></p>
    <p id="rasa"></p>
</div>

<button id="refresh">Force Refresh</button>
<br><br>
<a href="index.html">Back to Main Page</a>

<script>
async function loadValues() {
    const res = await fetch("/api/params");
    const data = await res.json();

    document.getElementById("imie").textContent = "Imię: " + data["Imię_1"];
    document.getElementById("nazwisko").textContent = "Nazwisko: " + data["Nazwisko_1"];
    document.getElementById("wiek").textContent = "Wiek: " + data["Wiek_1"];
    document.getElementById("plec").textContent = "Płeć: " + data["Płeć_1"];
    document.getElementById("rasa").textContent = "Rasa: " + data["Rasa_1"];
}

// Load on open
loadValues();

// SSE live reload on A1 change
const evt = new EventSource("/events");
evt.onmessage = (e) => {
    const msg = JSON.parse(e.data);
    if (msg.update) loadValues();
};

// Manual refresh button
document.getElementById("refresh").onclick = async () => {
    await fetch("/api/refresh");
    loadValues();
};
</script>

</body>
</html>
